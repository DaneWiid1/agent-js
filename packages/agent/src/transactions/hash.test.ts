import { sha256 } from './hash';

describe('Hash', () => {
  describe('sha256', () => {
    it('should return an expected sha256 of an encoded transaction', () => {
      const encodedTransaction = new Uint8Array([
        163, 0, 161, 2, 164, 0, 120, 64, 54, 54, 97, 98, 55, 53, 102, 56, 49, 102, 55, 57, 101, 54,
        57, 52, 99, 54, 51, 53, 53, 55, 52, 100, 49, 97, 98, 102, 99, 98, 48, 55, 54, 48, 98, 100,
        102, 98, 54, 98, 49, 97, 102, 51, 99, 98, 99, 56, 102, 98, 50, 57, 54, 54, 55, 51, 57, 48,
        49, 54, 48, 102, 53, 98, 1, 120, 64, 48, 54, 50, 98, 98, 98, 55, 97, 51, 53, 100, 101, 51,
        57, 50, 57, 51, 54, 99, 101, 98, 101, 49, 56, 49, 101, 100, 56, 51, 100, 97, 51, 56, 49, 49,
        52, 54, 99, 57, 52, 57, 49, 57, 100, 57, 54, 98, 50, 51, 56, 53, 97, 52, 48, 99, 52, 53, 48,
        55, 100, 52, 51, 53, 102, 2, 161, 0, 27, 0, 0, 4, 120, 124, 107, 102, 128, 3, 161, 0, 25,
        39, 16, 1, 27, 165, 67, 202, 170, 31, 6, 214, 128, 2, 161, 0, 27, 23, 62, 31, 3, 5, 162,
        195, 224,
      ]);
      const result = sha256(encodedTransaction);
      const expected = 'fe78107614727637420b9c480e651c4ffa65930c623cac0882f1dff439796029';

      expect(result).toEqual(expected);
    });

    it('should return an expected sha256 of an encoded transaction', () => {
      const encodedTransaction = new Uint8Array([
        163, 0, 161, 2, 164, 0, 120, 64, 50, 50, 48, 99, 51, 97, 51, 51, 102, 57, 48, 54, 48, 49,
        56, 57, 54, 101, 50, 54, 102, 55, 54, 102, 97, 54, 49, 57, 102, 101, 50, 56, 56, 55, 52, 50,
        100, 102, 49, 102, 97, 55, 53, 52, 50, 54, 101, 100, 102, 97, 102, 55, 53, 57, 100, 51, 57,
        102, 50, 52, 53, 53, 97, 53, 1, 120, 64, 54, 54, 97, 98, 55, 53, 102, 56, 49, 102, 55, 57,
        101, 54, 57, 52, 99, 54, 51, 53, 53, 55, 52, 100, 49, 97, 98, 102, 99, 98, 48, 55, 54, 48,
        98, 100, 102, 98, 54, 98, 49, 97, 102, 51, 99, 98, 99, 56, 102, 98, 50, 57, 54, 54, 55, 51,
        57, 48, 49, 54, 48, 102, 53, 98, 2, 161, 0, 27, 0, 0, 4, 120, 66, 169, 115, 96, 3, 161, 0,
        25, 39, 16, 1, 27, 0, 0, 1, 133, 222, 154, 150, 253, 2, 161, 0, 27, 23, 60, 239, 234, 90,
        95, 221, 163,
      ]);
      const result = sha256(encodedTransaction);
      const expected = 'b842a40a217d30c9834f9916a37aecbf53399f78b81a2c00a14fce06d12157ed';

      expect(result).toEqual(expected);
    });
  });
});
